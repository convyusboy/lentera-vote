var $container,initPreview,_ref,_ref1;window.previewHelpers.getContentType=function(headers){var key,val,_ref;return headers&&null!=(_ref=function(){var _results;_results=[];for(key in headers)val=headers[key],"content-type"===key.toLowerCase()&&_results.push(val);return _results}())?_ref[0]:void 0},window.previewHelpers.helpers={escapeLtExp:/</g,escapeGtExp:/>/g,escapeAmpExp:/&/g,escape:function(str){return JSON.stringify(str).replace(window.previewHelpers.helpers.escapeLtExp,"\\u003C").replace(window.previewHelpers.helpers.escapeGtExp,"\\u003E").replace(window.previewHelpers.helpers.escapeAmpExp,"\\u0026")},rubyKey:function(str){return str.replace(/\-/g,"_").toLowerCase()},getContentType:window.previewHelpers.getContentType,getContentTypeBrush:function(headers){return window.previewHelpers.getContentTypeBrush(window.previewHelpers.getContentType(headers))},isNotEmpty:function(obj){var i;for(i in obj)return!0;return!1}},null!=(null!=(_ref=window.previewHelpers)?_ref.callbackName:void 0)&&(window.previewHelpers.codeSampleContext=function(resource,mockserverUrl,requestNum){var requestObj,_ref1;return null==requestNum&&(requestNum=0),requestObj=(null!=(_ref1=resource.requests)?_ref1[requestNum]:void 0)||resource.request||{},{headers:requestObj.headers,body:requestObj.body,method:resource.method,url:resource.url,parameters:!1,apiUrl:mockserverUrl,contentType:window.previewHelpers.getContentType(requestObj.headers),helpers:window.previewHelpers.helpers}},$container=null),(null!=(_ref1=window.previewHelpers)?_ref1.callbackName:void 0)&&(window.previewHelpers.receivedMessage=function(ev){var api,data,ex,exc,origin,originTest,resource,schema,section,_i,_j,_k,_len,_len1,_len2,_ref2,_ref3,_ref4,_ref5;if(ev=ev.originalEvent,origin=ev.origin||ev.domain||location.host,origin=origin.replace(/^(http(s)?:\/\/)/g,"").split(":",2).shift(),originTest=new RegExp(""+window.baseDomain+"$","i"),window.docResources={},originTest.test(origin)){try{data=JSON.parse(ev.data)}catch(_error){return exc=_error,alert("Something went wrong with Preview window, we are very sorry.\n"+exc),!1}if(api=data.api){$container.empty();try{api=ApiaryBlueprintParser.ast.Blueprint.fromJSON(api)}catch(_error){return ex=_error,$container.html("<h1>Failed parsing...</h1><p>"+ex+"</p>"),!1}if(api){for(api.description&&(api.description=api.htmlDescription||window.marked(api.description)),_ref2=api.sections,_i=0,_len=_ref2.length;_len>_i;_i++)if(section=_ref2[_i],section.description&&(section.description=section.htmlDescription||window.marked(section.description)),!(api.version>2))for(_ref3=section.resources,_j=0,_len1=_ref3.length;_len1>_j;_j++)if(resource=_ref3[_j],resource.description&&(resource.description=window.marked(resource.description)),(null!=(_ref4=api.validations)?_ref4.length:void 0)>0)for(resource.schema=[],_ref5=api.validations,_k=0,_len2=_ref5.length;_len2>_k;_k++)schema=_ref5[_k],schema.method===resource.method&&schema.url===resource.url&&resource.schema.push({body:schema.body});return window.config.ectRender.render("docs/docs",{api:api,mockserverUrl:window.previewHelpers.mockserverUrl,codeSampleContext:window.previewHelpers.codeSampleContext,suite:{location:!1,_id:null},toc:[],hasTOC:!1,disabled:{comments:!0,tryit:!0,"debugger":!0},cors:!1,languages:window.config.languages,getStaticFile:function(filePath){return filePath},getContentType:window.previewHelpers.getContentType,getContentTypeBrush:window.previewHelpers.helpers.getContentTypeBrush,getReadableStatusCode:function(statusCode){var str;return str=statusCode,window.previewHelpers.HTTP_CODES[statusCode]&&(str+=" ("+window.previewHelpers.HTTP_CODES[statusCode]+")"||""),str},isPreview:!0},function(error,html){return error?(alert("There was an error during rendering Preview.\n"+error),!1):($container.html(html),void setTimeout(function(){window.prepareLanguageChoices(function(key,val){return window.parent.postMessage(JSON.stringify({called:"cookie",value:val,key:key}),"*")}),window.selectCode(null,null,null),window.parent.postMessage(JSON.stringify({called:"preview",rendered:!0}),"*")},100))})}}}},window[window.previewHelpers.callbackName]=function(data){var a,ex;window.config.ectRender=window.ECT({root:data.root,ext:".html",watch:!1});try{return a=window.parent.postMessage(JSON.stringify({called:"loaded",key:"preview"}),"*")}catch(_error){return ex=_error,a=$(window.parent.document),a.find("#documentationContainer").addClass("doneInit"),a.find("#previewBlueprint").removeClass("visuallyhidden")}}),initPreview=function(){return $(window).bind("message",window.previewHelpers.receivedMessage),$container=$("#container"),window.marked.setOptions({gfm:!0,tables:!0,breaks:!1,pedantic:!0,sanitize:!1,smartLists:!1,silent:!1,highlight:null,headerPrefix:"preview_"+$.now()+"_"})};