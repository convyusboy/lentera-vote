var beforePrint,downloadDebugger,mediaQueryList,prepareRunnableExample,receivedMessage,renderExampleCodes,runExample,tryItReady,_ref;window.readCookie=function(name){var c,ca,i,nameEQ;for(nameEQ=escape(name)+"=",ca=document.cookie.split(";"),i=0;i<ca.length;){for(c=ca[i];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(nameEQ))return unescape(c.substring(nameEQ.length,c.length).replace(/"/g,""));i++}},window.setCookie=function(cookieName,cookieValue,expire){return null==expire&&(expire=null),expire||(expire=new Date,expire.setDate(expire.getDate()+10950)),document.cookie=escape(cookieName)+"="+escape(cookieValue)+";expires="+expire.toGMTString()+";domain=."+window.baseDomain+";path=/"},prepareRunnableExample=function(node,replaceFrom,replaceTo){var area,code,iframe,submit,uuid;return node=node.find("form:first"),area=$("<textarea cols='80' rows='12' class='jsTryExample'></textarea>"),code=node.closest("section.resource").find("section.example section.javascript:first .jsRunCode").text(),replaceFrom&&replaceTo&&(code=code.replace(replaceFrom,replaceTo)),area.val(code.replace(/^\s+|\s+$/g,"")),node.find(".jsEmptyTryit").replaceWith(area),submit=$('<input type="submit" class="button big yellow" value="Try It" class="jsRunExample">'),node.append(submit),uuid=$.now(),node.addClass("tryForm"+uuid),iframe=$("<iframe onload=\"javascript:window.tryItReady('form.tryForm"+uuid+'\');" id="iframe_id_'+uuid+'" width="0px" height="0px" src="'+window.runExampleIframeUrl+"?"+uuid+'"></iframe>'),node.append(iframe)},tryItReady=function(uuid){return $(uuid).addClass("tryItReady")},runExample=function(node){var code,iframe;return node.find("input.button.big:first").val("Running…"),node.closest("section.resource").find("section.debugger").empty(),code=node.find("textarea.jsTryExample:first").val(),iframe=node.find("iframe:first").get(0).contentWindow,iframe.postMessage(code,"*")},receivedMessage=function(ev){var data,exc,messageText,origin,originTest,responseArea,tryItForm,uuid;if(ev=ev.originalEvent,origin=ev.origin||ev.domain||location.host,origin=origin.replace(/^(http(s)?:\/\/)/g,"").split(":",2).shift(),originTest=new RegExp(""+window.baseDomain+"$","i"),originTest.test(origin)){try{data=JSON.parse(ev.data)}catch(_error){return exc=_error,alert("Something went wrong with Try It window, we are very sorry.\n"+exc),!1}return uuid=data.uuid,tryItForm=$("form.tryForm"+uuid),tryItForm.find("input.button.big:first").val("Try It"),responseArea=tryItForm.next(".responseArea"),delete data.uuid,0===responseArea.length&&(responseArea=$('<div class="responseArea"><pre class="response"></pre></div>').insertAfter(tryItForm)),messageText="Status: "+data.status+" ("+data.statusText+")\nHeaders: "+JSON.stringify(data.headers,null,"    ")+"\nResponseBody: "+JSON.stringify(data.responseText,null,"    "),responseArea.children().attr("name",(new Date).toISOString().replace("T"," ").replace(/\..+/,"")).text(messageText)}},(null!=(_ref=window.previewHelpers)?_ref.callbackName:void 0)||$(window).bind("message",receivedMessage),$(document).ready(function(){var cancelComment,closeComment,item,loggedIn,loginUrl,mockserverUrl,pendingTarget,postComment,selectText,showTrafficUri,submitComment,tryItUrl;return loginUrl=window.jsLoginUrl,loggedIn=window.jsLoggedIn,tryItUrl=window.tryItUrl,mockserverUrl=window.mockserverUrl,pendingTarget=!1,$("body").keyup(function(e){return 27===e.keyCode?$(".loginOverlay").hide():void 0}),$(".loginOverlay").on("click",".close,.closeLayer",function(){return $(".loginOverlay").hide()}),$('<div id="fontSizeSwitch" title="Adjust Font Size"></div>').appendTo("#leftColumn").append($('<ul class="layerOver"></ul>').append(function(){var _i,_len,_ref1,_results;for(_ref1=["Normal","M","L","XL"],_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)item=_ref1[_i],_results.push($('<li class="fontSizeItem fontSize'+item+'">a</li>'));return _results}())),$("#fontSizeSwitch li.fontSizeItem").bind("click",function(){var fontSize,fontSizes,newClassName;return newClassName=this.className.replace(/(fontSizeItem|active)/g,"").trim(),$("#container").attr("class",newClassName),$(this).addClass("active").siblings().removeClass("active"),fontSize=newClassName.replace("fontSize",""),fontSizes={XL:"20",L:"15",M:"14",Normal:"13",S:"12"}}).first().addClass("active"),$("#container").delegate("section.resource > hgroup, section.resource > article.details","click",function(e){var node,target,whiteListedFound,_i,_len,_ref1;if(target=$(e.target),whiteListedFound=target.closest(".resourcePermalink").length>0||target.filter("article.details a").length>0,!whiteListedFound)for(_ref1=target.parents(),_i=0,_len=_ref1.length;_len>_i;_i++){if(node=_ref1[_i],node=$(node),node.filter(".resourcePermalink, article.details a").length>0){whiteListedFound=!0;break}if(node.filter(".resource hgroup, .resource article.details").length>0)break}whiteListedFound||(e.preventDefault(),e=target.closest(".resource").toggleClass("expanded").find("section.code:not(.processed)"),e&&e.length>0&&renderExampleCodes(e))}).on("click","nav.switch ul a",function(e){var button,nav,otherButtons,otherSections,target,targetSections,toggle;if(e.stopPropagation(),e.preventDefault(),button=$(this),nav=button.closest("nav.switch"),target=button.attr("href").replace(/^#/,"."),".all"===target&&(target="*"),toggle=nav.children(".toggle"),otherButtons=button.siblings(),targetSections=nav.parent().children("section"+target),otherSections=targetSections.siblings("section"),button.hasClass("active")?toggle.length>0&&(button.removeClass("active"),targetSections.hide(),nav.removeClass("expanded")):(button.addClass("active"),otherButtons.removeClass("active"),targetSections.show(),otherSections.hide(),toggle.length>0&&nav.addClass("expanded")),targetSections=targetSections.eq(0),".debugger"===target&&0===targetSections.children().length)return downloadDebugger(targetSections);if(".example"===target){if(targetSections=targetSections.find("section.code:not(.processed)"),targetSections&&targetSections.length>0)return renderExampleCodes(targetSections)}else if(".tryit"===target&&0!==targetSections.find(".jsEmptyTryit").length)return prepareRunnableExample(targetSections,mockserverUrl,tryItUrl)}),$(".resource .commentsCount a").on("click",function(e){var resource;return e.stopPropagation(),e.preventDefault(),resource=$(this).closest(".resource"),resource.hasClass("expanded")&&resource.find("nav.switch ul a[href=#social]").hasClass("active")?resource.removeClass("expanded"):(resource.find(".content > section").hide().filter(".social").show(),resource.find("nav.switch ul a").removeClass("active").filter("[href=#social]").addClass("active"),resource.addClass("expanded"))}),$("section.resource").on("focus",".newPost textarea",function(e){return e.preventDefault(),$(this).closest(".newPost").addClass("focused"),$(this).on("blur",function(e){var _this=this;return setTimeout(function(){return""===$(_this).val()?cancelComment(e):void 0},0)})}),$("section.resource").on("click",".newPost .cancel",function(e){return cancelComment(e)}),closeComment=function(el){var newPost;return newPost=$(el).closest(".newPost"),newPost.find("textarea").val(""),newPost.removeClass("focused"),newPost.find("textarea").off("blur",closeComment)},cancelComment=function(e){return e.preventDefault(),e.stopPropagation(),closeComment(e.target)},postComment=function(target){return $.post(target.attr("action")+"?xhr=1",target.serialize(),function(data){var dataNode,section,social;return social=target.closest(".social"),dataNode=$(data),section=target.closest("ol.thread").parents("article"),section.length>0?section.remove():closeComment(target),social.children("[name=thread]").prepend(dataNode)})},window.postPendingComment=function(){var jsLoggedIn;return postComment(pendingTarget),pendingTarget=!1,$(".loginOverlay").hide(),loggedIn=jsLoggedIn=!0},submitComment=function(e,target){return e.preventDefault(),e.stopPropagation(),target.find("textarea").val()?loggedIn?postComment(target):(pendingTarget=target,window.resumeAction=window.postPendingComment,$("div#loginPicker").show()):void 0},$("section").on("submit",".newPost form",function(e){return submitComment(e,$(this))}),showTrafficUri=function(e){return e.preventDefault(),e.stopPropagation(),window.resumeAction=function(){return window.location.reload()},$("div#loginPicker").show()},$("#container").on("click","#trafficLogin,.trafficLogin",function(e){return showTrafficUri(e,$(this))}),selectText=function(element){var range,selection;return range=null,document.body.createTextRange?(range=document.body.createTextRange(),range.moveToElementText(element),range.select()):window.getSelection?(selection=window.getSelection(),range=document.createRange(),range.selectNodeContents(element),selection.removeAllRanges(),selection.addRange(range)):void 0},$("section.example").on("dblclick","pre",function(){$(this).closest("section.example").addClass("selectAll"),selectText(this)}),$("body").bind("click",function(){return $("section.example.selectAll").removeClass("selectAll")})}),downloadDebugger=function(sectionEl){var signature,url;return sectionEl=$(sectionEl),signature=sectionEl.attr("data-resource-signature").split(" "),sectionEl.html('<p class="noTraffic"><span class="ajaxLoader"></span></p>'),url="/api/traffic",window.trafficSecret&&(url=url+"/"+window.trafficSecret),$.ajax(url,{data:{method:signature[0],url:signature[1]},success:function(data){return sectionEl.html(data)},error:function(){return sectionEl.html("<p>Sorry, error while loading traffic. Please reload and try again.</p>")}})},$(document).ready(function(){var $doc,appLoginDiv,cookieName,cssRight,highlightForFirst,loggedIn,loginDiv,scrollTocFn,selectedLanguage,toc,tocOffset,winOverhang,_ref1;return loggedIn=window.jsLoggedIn,loginDiv=$("div#loginPicker"),appLoginDiv=$("div#appLogin"),$("#endpoints input[type=text]").click(function(){return $(this).focus().select()}).mouseup(function(e){return e.preventDefault()}),$(".details > ul").has("li:nth-child(17n)").addClass("toggle").after('<a class="toggler" href="#">Show more…</a>'),$(".toggler").click(function(e){var ul;return e.preventDefault(),ul=$(e.target).prev(),"200px"===ul.css("height")?(ul.css({height:"auto"}),$(e.target).text("Show less…")):(ul.css({height:"200px"}),$(e.target).text("Show more…"))}),toc=$("#rightColumn"),toc.is(":visible")&&(toc=toc.first(),tocOffset=toc.offset().top,cssRight=parseInt(toc.css("right"),10),winOverhang=toc.width()+toc.position().left<$(window).width(),$(window).resize(function(){return winOverhang=toc.width()+toc.position().left<$(window).width()}),$doc=$(document),scrollTocFn=function(){winOverhang&&$doc.scrollTop()>tocOffset-17?toc.addClass("floating"):toc.removeClass("floating")},$doc.bind("scroll",scrollTocFn)),$(".social textarea[name=comment]").on("focus",function(e){var textarea;return textarea=$(e.target),textarea.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){var form,formTag,win;if("height"===e.originalEvent.propertyName)return textarea.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),formTag=textarea.closest("form"),form={top:formTag.offset().top,height:formTag.outerHeight()},win={top:$(document).scrollTop(),height:$(window).height()},form.bottom=form.top+form.height,win.bottom=win.top+win.height,win.top>form.top&&$(document).scrollTop(form.top-10),win.bottom<form.bottom?$(document).scrollTop(form.bottom-win.height+10):void 0})}),loginDiv.click(function(e){var href,link,type,win;return e.stopPropagation(),e.preventDefault(),link="A"===e.target.tagName?$(e.target):$(e.target).parents("a"),href=link.attr("href"),type=link.data("type"),"apiary"===type?(loginDiv.hide(),appLoginDiv.show()):"github"===type||"twitter"===type?win=window.open(href,"external login",{width:"200px",height:"200px",toolbar:0}):void 0}),appLoginDiv.find("form:first").submit(function(e){var request,target;return e.preventDefault(),e.stopPropagation(),target=$(this),request=new XMLHttpRequest,request.onreadystatechange=function(){var p,res;if(this.readyState===this.DONE){if(200===this.status)return appLoginDiv.hide(),window.resumeAction();if(console&&console.log("Request went wrong, status",this.status),request.responseText&&(res=JSON.parse(request.responseText),res.message))return $(".messages").remove(),p=$('<p class="error messages"></p>'),p.html(res.message),p.insertAfter($("#loginUL")),p.show()}},request.open("POST",target.attr("action")),request.withCredentials=!0,request.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),request.send(target.serialize())}),loggedIn&&$("#documentationContainer").on("submit",'form[name="delete"]',function(e){var target;return target=$(this),e.preventDefault(),e.stopPropagation(),$.post(target.attr("action")+"?xhr=1",target.serialize(),function(res){var container;return"ok"===res.status?(container=target.closest(".thread"),container.find(".post:first")[0]===target.closest(".post")[0]?container.remove():target.closest(".post").parent().remove()):alert("Deletion failed")})}),cookieName="language-sample",highlightForFirst=!0,selectedLanguage="raw",window.selectCode=function(cookieName,eventElement,selectedLanguage){var $sections,elementYOffset,screenYOffset;return null==cookieName&&(cookieName="language-sample"),null==eventElement&&(eventElement=!1),eventElement&&(elementYOffset=eventElement.offset().top),screenYOffset=window.pageYOffset,selectedLanguage=selectedLanguage||window.readCookie(cookieName)||"raw",$('form[name="languageSwitcher"] select').val(selectedLanguage),$sections=$('#leftColumn section:not(.highlighted)[name="'+selectedLanguage+'"]').each(function(){return highlightForFirst||Prism.highlightAll(this),this.className+=" highlighted"}).nextAll("section.outgoingCall:not(.highlighted)"),$sections&&$sections.size()>0&&$sections.each(function(){return this.className+=" highlighted",highlightForFirst?void 0:Prism.highlightAll(this)}),highlightForFirst&&(highlightForFirst=!1),$("#leftColumn").attr("class",selectedLanguage+"Example"),eventElement?window.scrollTo(window.pageXOffset,screenYOffset+eventElement.offset().top-elementYOffset):void 0},window.prepareLanguageChoices=function(cb){return $("#documentationContainer").on("change",'form[name="languageSwitcher"] select',function(e){var _this=this;return setTimeout(function(){return e=$(_this),selectedLanguage=e.val(),window.setCookie(cookieName,selectedLanguage),window.selectCode(cookieName,e.closest("section.resource"),selectedLanguage),cb&&cb(cookieName,selectedLanguage),!1},50)})},null==(null!=(_ref1=window.previewHelpers)?_ref1.callbackName:void 0)&&(window.selectCode(cookieName),window.prepareLanguageChoices()),$("#container").on("submit",'form[name="jsRunExample"]',function(e){return e.preventDefault(),e.stopPropagation(),runExample($(this))})}),renderExampleCodes=function(sectionCode,languageKeys){var context,contextKey,contexts,counter,exc,expandedUriTemplate,langKey,languageKey,languageText,resourceUrl,templ,_i,_j,_len;if(!sectionCode.hasClass("processed")&&window.config.ectRender&&(contexts=window.docResources[sectionCode.attr("id")])){if("[object Array]"!==Object.prototype.toString.call(contexts)&&(contexts=[contexts]),counter=0,null==languageKeys&&(languageKeys=function(){var _ref1,_results;_ref1=window.config.languages,_results=[];for(languageKey in _ref1)languageText=_ref1[languageKey],_results.push(languageKey);return _results}().reverse()),sectionCode.addClass("processed"),0===contexts.length)return;if(resourceUrl=expandedUriTemplate=!1,contexts[0].parameters&&window.UriTemplate){templ=resourceUrl=""+contexts[0].url;try{templ=window.UriTemplate.parse(templ),templ=templ.expand(contexts[0].parameters)}catch(_error){exc=_error,templ=!1}templ&&resourceUrl!==templ&&(expandedUriTemplate=!0,resourceUrl=""+templ)}for(_i=0,_len=languageKeys.length;_len>_i;_i++)for(langKey=languageKeys[_i],contextKey=_j=contexts.length-1;_j>=0;contextKey=_j+=-1)context=contexts[contextKey],context=$.extend(context,{apiUrl:window.previewHelpers.mockserverUrl,helpers:window.previewHelpers.helpers}),expandedUriTemplate&&resourceUrl&&(context.url=resourceUrl),window.config.ectRender.render("docs/examples/"+langKey,context,function(err,html){return++counter,err?(console.log("Rendering language FAILED !!!",err),alert("There was an error when rendering language example code. Please try refreshing the page."),!1):sectionCode.prepend(html)});if(expandedUriTemplate&&sectionCode.parent().addClass("expandedUriTemplate"),counter>=contexts.length*languageKeys.length)return sectionCode.children("section").addClass("highlighted"),Prism.highlightAll(sectionCode.get(0))}else if(!sectionCode.hasClass("processed"))return sectionCode.children("section").addClass("highlighted"),Prism.highlightAll(sectionCode.get(0))},$(window).load(function(){var loc;return loc=window.location,loc.hash&&"#"!==loc.hash?setTimeout(function(){var destination,searchedElement,_ref1;return searchedElement=$('a.resourcePermalink[href="#'+loc.href.split("#",2).pop()+'"]:first'),searchedElement.length>0&&(searchedElement=searchedElement.closest("hgroup").trigger("click"),searchedElement.length>0&&(destination=null!=(_ref1=searchedElement.offset())?_ref1.top:void 0))?$("html:not(:animated),body:not(:animated)").animate({scrollTop:destination-30},300):void 0},50):void 0}),beforePrint=function(){var $resources,baseContext,languageKey,languageKeys,languageText;return $resources=$("#leftColumn section.resource section.code:not(.processed)"),$resources.length>0?(baseContext={apiUrl:window.previewHelpers.apiUrl,helpers:window.previewHelpers.helpers},languageKeys=function(){var _ref1,_results;_ref1=window.config.languages,_results=[];for(languageKey in _ref1)languageText=_ref1[languageKey],_results.push(languageKey);return _results}(),$resources.each(function(indexOfEl,element){return renderExampleCodes($(element),languageKeys)})):void 0},window.matchMedia&&(mediaQueryList=window.matchMedia("print"),mediaQueryList.addListener(function(mql){return mql.matches?beforePrint():void 0})),window.onbeforeprint=beforePrint;